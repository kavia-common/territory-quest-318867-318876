{"is_source_file": true, "format": "JavaScript (Node.js)", "description": "This file is the main server setup script for a Node.js backend application. It initializes an Express server, sets up middleware (security, CORS, rate limiting, logging, request timeout), defines health check and API routes, configures WebSocket server, and handles graceful shutdown procedures.", "external_files": ["./middleware/errorHandler.js", "./middleware/requestLogger.js", "./middleware/requestTimeout.js", "./middleware/notFoundHandler.js", "./utils/logger.js", "./routes/index.js", "./routes/health.js", "./websocket/index.js"], "external_methods": ["errorHandler", "requestLogger", "requestTimeout", "notFoundHandler", "initializeWebSocket"], "published": ["app", "httpServer", "wss", "gracefulShutdown"], "classes": [], "methods": [{"name": "gracefulShutdown", "description": "Handles graceful termination of server and WebSocket connections upon receiving termination signals."}, {"name": "AnonymousFunctionbcb6272f0100(origin, callback)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["dotenv.config", "express()", "createServer(app)", "helmet()", "cors()", "rateLimit()", "express.json()", "express.urlencoded()", "app.use()", "requestLogger", "requestTimeout", "healthRoutes", "routes", "notFoundHandler", "errorHandler", "initializeWebSocket", "httpServer.listen", "logger.info", "logger.warn", "logger.error", "wss.clients.forEach", "client.close", "wss.close", "setTimeout", "setInterval", "clearInterval", "clearTimeout", "process.on"], "search-terms": ["WebSocketServer", "initializeWebSocket", "gracefulShutdown", "express-rate-limit", "dotenv", "helmet", "cors", "Health Routes", "Error Handling Middleware", "Environment Configuration"], "state": 2, "file_id": 6, "knowledge_revision": 77, "git_revision": "6d79e27fd64839ad21aa8f41944d816f6dd38be0", "revision_history": [{"33": "c2b4720579c8e11ff8f0ec060c27f46eeddaf35b"}, {"77": "6d79e27fd64839ad21aa8f41944d816f6dd38be0"}], "ctags": [{"_type": "tag", "name": "ALLOWED_ORIGINS", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^const ALLOWED_ORIGINS = process.env.ALLOWED_ORIGINS$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "AnonymousFunctionbcb6272f0100", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^  origin: function (origin, callback) {$/", "language": "JavaScript", "kind": "function", "signature": "(origin, callback)"}, {"_type": "tag", "name": "NODE_ENV", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^const NODE_ENV = process.env.NODE_ENV || 'development';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "PORT", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^const PORT = process.env.PORT || 3001;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "REQUEST_TIMEOUT_MS", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^const REQUEST_TIMEOUT_MS = parseInt(process.env.REQUEST_TIMEOUT_MS || '30000');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^const app = express();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "checkConnections", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^  const checkConnections = setInterval(() => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "gracefulShutdown", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^const gracefulShutdown = (signal) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "httpServer", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^const httpServer = createServer(app);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "isShuttingDown", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^let isShuttingDown = false;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "limiter", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^const limiter = rateLimit({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "shutdownTimeout", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^  const shutdownTimeout = setTimeout(() => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "wss", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/server.js", "pattern": "/^const wss = new WebSocketServer({ $/", "language": "JavaScript", "kind": "constant"}], "hash": "66d556f4476effa41cdb6db1c1c51abf", "format-version": 4, "code-base-name": "game_backend", "filename": "game_backend/src/server.js", "fields": [{"name": "let isShuttingDown = false;", "scope": "", "scopeKind": "", "description": "unavailable"}]}