{"is_source_file": true, "format": "SQL", "description": "This file defines the database schema for a game backend, including tables for users, zones, missions, notifications, activity logs, indexes, constraints, helper functions, and triggers. It sets up data structures, relationships, constraints, spatial indexes, and utility functions relevant to managing game state, spatial zones, user progress, and notifications.", "external_files": ["auth.users", "postgis", "gen_random_uuid()"], "external_methods": ["ST_MakeEnvelope", "COALESCE", "COS", "RADIANS", "FLOOR", "GREATEST", "LEAST", "jsonb_build_object"], "published": ["generate_grid_id", "generate_zone_geom", "get_zone_id_at_location", "calculate_respect_level", "award_ep"], "classes": [], "methods": [{"name": "generate_grid_id", "description": "Generates a unique grid ID based on latitude and longitude, dividing the globe into 50m x 50m cells at the equator, adjusted for latitude."}, {"name": "generate_zone_geom", "description": "Creates a polygon geometry representing a 50m x 50m zone polygon aligned with grid cells based on provided latitude and longitude."}, {"name": "get_zone_id_at_location", "description": "Returns the grid_id for the zone that contains the provided geographic coordinates."}, {"name": "calculate_respect_level", "description": "Calculates a user's respect level from total EP, scaled logarithmically."}, {"name": "award_ep", "description": "Awards experience points to a user, adjusts respect level, and logs the activity, with notification for level-up."}], "calls": ["generate_grid_id", "generate_zone_geom", "get_zone_id_at_location", "calculate_respect_level", "award_ep"], "search-terms": ["PostGIS", "zone_status", "activity_log", "generate_zone", "spatial indexes", "ep and respect calculation", "trigger functions", "UUID generation", "user activity tracking", "game backend schema"], "state": 2, "file_id": 2, "knowledge_revision": 10, "git_revision": "536fe4a6b2fa0c3b8cdf9e84c981fc2aac9de21e", "revision_history": [{"7": "2d4acf7d979bf16a753d2fd3d0fb320f3da6caa4"}, {"10": "536fe4a6b2fa0c3b8cdf9e84c981fc2aac9de21e"}], "hash": "b9949eb2ab083a21e84586f2264ee5a6", "format-version": 4, "code-base-name": "game_backend", "filename": "game_backend/schema.sql"}