{"is_source_file": true, "format": "JavaScript", "description": "This file defines Express.js route handlers for managing user notifications in a web application's backend. It includes endpoints to retrieve notifications, mark individual notifications as read, and mark all notifications as read. The file utilizes middleware for authentication and request validation, calls external RPC functions, and logs errors.", "external_files": ["../middleware/auth.js", "../utils/supabase.js", "../utils/logger.js"], "external_methods": ["authenticate", "callRPC", "logger.error"], "published": ["router"], "classes": [], "methods": [{"name": "validate", "description": "A middleware utility function to validate request parameters, query, and body using Joi schemas."}], "calls": ["callRPC('get_user_notifications', ...)", "callRPC('mark_notification_read', ...)", "callRPC('mark_all_notifications_read', ...)"], "search-terms": ["notifications routes", "mark notification read", "get notifications", "mark all read", "express route handlers"], "state": 2, "file_id": 17, "knowledge_revision": 60, "git_revision": "b6e1afb1699bb8488e9e9a23dadccf9079ddfd56", "revision_history": [{"44": "c2b4720579c8e11ff8f0ec060c27f46eeddaf35b"}, {"60": "b6e1afb1699bb8488e9e9a23dadccf9079ddfd56"}], "ctags": [{"_type": "tag", "name": "abortEarly", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/routes/notifications.js", "pattern": "/^      abortEarly: false,$/", "language": "JavaScript", "kind": "property", "scope": "validationOptions", "scopeKind": "class"}, {"_type": "tag", "name": "allowUnknown", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/routes/notifications.js", "pattern": "/^      allowUnknown: true,$/", "language": "JavaScript", "kind": "property", "scope": "validationOptions", "scopeKind": "class"}, {"_type": "tag", "name": "errors", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/routes/notifications.js", "pattern": "/^      const errors = error.details.map(detail => ({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/routes/notifications.js", "pattern": "/^const router = express.Router();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "schemaToValidate", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/routes/notifications.js", "pattern": "/^    const schemaToValidate = Joi.object(schema);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "stripUnknown", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/routes/notifications.js", "pattern": "/^      stripUnknown: true$/", "language": "JavaScript", "kind": "property", "scope": "validationOptions", "scopeKind": "class"}, {"_type": "tag", "name": "toValidate", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/routes/notifications.js", "pattern": "/^    const toValidate = {};$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "validate", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/routes/notifications.js", "pattern": "/^const validate = (schema) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "validationOptions", "path": "/home/kavia/workspace/code-generation/territory-quest-318867-318876/game_backend/src/routes/notifications.js", "pattern": "/^    const validationOptions = {$/", "language": "JavaScript", "kind": "class"}], "hash": "767df0d2a47fad3377f5b5e18ff2b446", "format-version": 4, "code-base-name": "game_backend", "filename": "game_backend/src/routes/notifications.js", "fields": [{"name": "abortEarly: false,", "scope": "validationOptions", "scopeKind": "class", "description": "unavailable"}, {"name": "allowUnknown: true,", "scope": "validationOptions", "scopeKind": "class", "description": "unavailable"}, {"name": "stripUnknown: true", "scope": "validationOptions", "scopeKind": "class", "description": "unavailable"}]}